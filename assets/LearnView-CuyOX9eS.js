import{q as Pt,k as Ge,l as Ze,m as Ke,c as et,o as Pe,a as $,d as St,b as Qe,w as Mt,T as jt,t as It,v as Tt,u as Ce,F as Dt,i as Nt,x as Ft}from"./vue-q1_PGPlY.js";import{p as qt,u as tt,P as Ot,s as Yt,E as At,a as Ht,H as Rt}from"./Header-Dj5am3yu.js";import{w as Xt,c as st,d as it,o as lt,e as nt,f as ot,g as k,u as zt,i as B,M as at,j as rt,k as Ve,m as Bt,n as be,L as te,C as Ut,l as Ee,b as Qt}from"./util-DZamdUmE.js";import{r as U}from"./index-Ca_GRw5L.js";import{_ as dt}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./xterm-CbIsyoms.js";import"./monaco-D2fC6ZYY.js";const ct=Pt("lesson",()=>{const i=Ge(!1);function e(){i.value=!1}return{loadingProgressTree:i,$reset:e}});let fe,T,S,O;const Vt=tt(),K=zt(),We=ct();function ht(i){if(Me=i.clientX,je=i.clientY,le=Me,ne=je,Q){if(be.length||we())return;oe=!0,gt()}}function ut(i){oe&&(localStorage.getItem("cc-lastLID")&&localStorage.removeItem("cc-lastLID"),localStorage.setItem("cc-panX",(C||0).toString()),localStorage.setItem("cc-panY",(E||0).toString()),localStorage.setItem("cc-zoom",(c||1).toString())),oe=!1}function pt(i){if(!be.length&&Q&&i.touches.length==2){Z=[...i.touches];let e=Z[1].clientX-Z[0].clientX,s=Z[1].clientY-Z[0].clientY;ye=Math.sqrt(e**2+s**2)}}function ft(i){if(!be.length&&(i.preventDefault(),!we())){if(i.touches.length==1){let e=i.touches[0];ae=e.clientX,re=e.clientY}if(i.touches.length==2){let e=i.touches[1].clientX-i.touches[0].clientX,s=i.touches[1].clientY-i.touches[0].clientY;ae=(i.touches[0].clientX+i.touches[1].clientX)/2,re=(i.touches[0].clientY+i.touches[1].clientY)/2;let t=Math.sqrt(e**2+s**2),l=t-ye;ye=t,Math.abs(l)>0&&Ae(1+l/300)}else if(oe){let e=i.touches[0];i.preventDefault();let s=e.clientX-le,t=e.clientY-ne;C+=s,E+=t,le=e.clientX,ne=e.clientY,V()}}}function mt(i){if(!K.warping&&(ae=i.clientX,re=i.clientY,oe)){if(i.preventDefault(),we())return;let e=i.clientX-le,s=i.clientY-ne;C+=e,E+=s,le=i.clientX,ne=i.clientY,V()}}function vt(i){if(K.warping||be.length||we())return;i.preventDefault();let e=Math.abs(i.deltaY)/500;i.deltaY!=Math.trunc(i.deltaY)&&(e*=8);let s=1.001+e;Ae(i.deltaY>0?1/s:s)}let se=null;function Je(i){let e=i.target;if(!e){console.warn("no view options button to open");return}let s=["Reset Camera/View"];lt(e,()=>s,t=>{t==0&&rs(),nt()})}function Wt(){T?.removeEventListener("pointerdown",ht),window.removeEventListener("pointerup",ut),window.removeEventListener("touchstart",pt),window.removeEventListener("touchmove",ft),window.removeEventListener("mousemove",mt),document.removeEventListener("wheel",vt),se!=null&&(clearInterval(se),se=null),O&&(O.textContent=""),xt()}function Jt(){T.addEventListener("pointerdown",ht),window.addEventListener("pointerup",ut),window.addEventListener("touchstart",pt),window.addEventListener("touchmove",ft,{passive:!1}),window.addEventListener("mousemove",mt),document.addEventListener("wheel",vt,{passive:!1}),C=parseFloat(localStorage.getItem("cc-panX"))||0,E=parseFloat(localStorage.getItem("cc-panY"))||0,c=parseFloat(localStorage.getItem("cc-zoom"))||1,wt(c),localStorage.getItem("cc-lastLID"),V(),se!=null&&clearInterval(se),se=setInterval(()=>{xe&&Lt()},500)}let _e={lesson:{label:"Lesson",icon:"school",accent:"var(--learn-col)",useLabel:!1},project:{label:"Guided Project",icon:"deployed_code",accent:"var(--experiment-col)",useLabel:!0},rush:{label:"Rush Lesson",icon:"bolt",accent:"var(--practice-col)",useLabel:!0},review:{label:"Review",icon:"checkbook",accent:"var(--practice-col)",useLabel:!0}};class Gt{constructor(e,s=!1){this.id=e,this.bendOther=s}id;bendOther;pathCont}class Zt{constructor(){}type;name;lid;x;y;next;prev;_x;_y;root;rootProg;desc=[];takeaways=[];preview=[];previewData;parent;sections;order;hide=!1;pub=!1;initialFiles;userFiles;getIcon(){return _e[te[this.type??0]].icon}getAccent(){return _e[te[this.type??0]].accent}getTypeData(){return _e[te[this.type??0]]}loadFromData(e){let s=Object.keys(e);for(const t of s){let l=e[t];this[t]=l}this.next?this.next=this.next.filter(t=>t.id!=this.lid):this.next=[],this.prev||(this.prev=[])}async animateUnlocks(e,s){X.length!=0&&await X[X.length-1].prom;let t=Y.find(L=>L.lid==this.lid);if(!t||t.data.u||(console.log("moving to",t.l.name,t.l.pub),!t.l.pub))return;let l,r={prom:new Promise(L=>l=L),res:l};X.push(r),os(),await k(500);let n=-t.l._x*c+T.offsetWidth/2*c,a=-t.l._y*c+T.offsetHeight/2*c,o=C-n,d=E-a,h=Math.sqrt(o**2+d**2),p=h,u=1,f=c-u,w=Math.abs(f),x=w,g=5,D=.05;for(;h>g||w>D;){if(h>g){let L=Math.cos(h/p*Math.PI*2-Math.PI)*.3+1.1;C-=.06*o*L,E-=.06*d*L,V(),await k(15),n=-t.l._x*c+T.offsetWidth/2*c,a=-t.l._y*c+T.offsetHeight/2*c,o=C-n,d=E-a,h=Math.sqrt(o**2+d**2)}if(w>D){let L=Math.cos(w/x*Math.PI*2-Math.PI)*.3+1.1;f=(c-u)*L,w=Math.abs(f),ae=t.l._x+C/c,re=t.l._y+E/c,Ae(1-f*.06)}}if(V(),await k(250),Lt(),t.data.u=!0,t.data.n=!0,t.update(),t.data.u&&t.l.pub){let L=Ie.filter(_=>_?.relObj==t);for(const _ of L)_.showObj()}await k(250);let W=X.indexOf(r);W!=-1&&X.splice(W,1),r.res(),as()}boardExtraData}let X=[];function Kt(i){console.log(i);let e=[],s=[...i.lessons];i.lessons=[];let t=[];for(const l of s)l.hide?t.push(l.lid):i.lessons.push(l);e:for(const l of i.lessons){for(const n of l.links)if(t.includes(n.to)){t.push(l.lid);continue e}let r=new Zt;r.loadFromData(l),r.prev=l.links?.map(n=>new Gt(n.to,n.flip))??[],r.type=l.ops.type??te.lesson,i.isDev&&(r.pub=!0),e.push(r)}return{ar:e,meta:i.meta}}let pe=[];function gt(){if(pe.length){for(const i of pe)i.close();pe=[]}}class es{constructor(e,s,t){t==null&&(t={lid:e.lid,eventI:-1,taskI:-1,prog:0,mode:0,wu:"",s:!1,n:!1,u:!1,times:0,ws:"",hf:!1,wls:"",sceneI:0}),this.lid=e.lid,this.l=e,this.e=s,this.data=t}e;l;lid;data;b_start;d_actions;tmp;isHovering;prevPathCont;close(){this.b_start&&(this.b_start.classList.remove("open"),this.d_actions.classList.remove("open"),this.isHovering||(this.b_start.textContent=this.tmp,this.data.s&&(this.b_start.classList.remove("material-symbols-outlined"),this.b_start.classList.add("percent"))))}open(){this.b_start&&(gt(),pe.push(this),this.b_start.classList.add("open"),this.d_actions.classList.add("open"),this.b_start.classList.add("material-symbols-outlined"),this.b_start.classList.remove("percent"),this.b_start.textContent="more_horiz")}addFlag(e){let s=this.e.querySelector(".flags");if(!s)return;let t=["new","complete","inprogress"].indexOf(e),l=document.createElement("div");l.innerHTML=["NEW","<span class='material-symbols-outlined'>check</span>","IN PROGRESS"][t],l.className="item-flag flag-"+e,s.appendChild(l)}partNum=0;setPartNum(e){this.partNum=e,this.e.style.setProperty("--content-override",'"// Part '+this.partNum+'"')}updateProgRef=void 0;update(){this.l.pub||(this.e.classList.contains("unfinished")||ot(this.e,"This lesson is unfinished.",n=>{n.style.textAlign="center"}),this.e?.classList.add("unfinished"),this.data.u=!1);let e=this.e,s=this.data.u;if(s?(e.parentElement.classList.remove("locked"),e.classList.remove("locked")):(e.parentElement.classList.add("locked"),e.classList.add("locked")),e.parentElement.style.left=this.l._x+"px",e.parentElement.style.top=this.l._y+"px",s){let n=e.parentElement.querySelector(".item-cont-icon");n||(n=document.createElement("div"),n.className="item-cont-icon",e.parentElement.appendChild(n));let a=this.l.getTypeData();a.useLabel&&a.label&&(e.parentElement.style.setProperty("--content-override",'"// '+a.label+'"'),e.parentElement.classList.add("labeled")),a.accent&&e.parentElement.style.setProperty("--co",a.accent),e.parentElement.querySelector(".item-cont-icon").style.setProperty("--icon",`"${a.icon}"`);let o=a.label.toLowerCase().replaceAll(" ","-");if(e.parentElement.classList.add("type-"+o),e.parentElement.classList.add("type-"+o+"-parent"),this.l.type==te.project){if(this.l.parent){let d=function(p){if(p&&p.parent){h++;for(const u of p.prev)d(Y.find(f=>f.lid==u.id)?.l)}},h=1;d(this.l),this.setPartNum(h)}}else if(this.l.type==te.review){let d=document.createElement("div");d.className="vert-beam",e.parentElement.appendChild(d)}}this.prevPathCont&&(this.data.hf?(console.log("HAS FINISHED"),this.prevPathCont.classList.add("done")):this.prevPathCont.classList.remove("done")),s?e.innerHTML=`
            <div><span class="l-lesson-name">${rt(this.l.name)}</span></div>
            <div class="btn-start ${this.data.s?"percent":"material-symbols-outlined"}">
                ${this.data.s?this.data.prog+"%":this.data.s?"more_horiz":"play_arrow"}
            </div>
            <div class="prog-circle">
                <canvas></canvas>
            </div>
            <!--${this.data.s?`
            <div class="prog-label">
                <span class="material-symbols-outlined" style="font-size:16px;margin-right:5px">check</span>
                <span>${this.data.prog}% Complete</span>
            </div>
            `:""}-->
            <div class="flags"></div>
            <div class="item-actions">
                ${this.data.prog!=100?`<div>
                    <div>play_arrow</div>
                    <div>Resume</div>
                </div>`:`
                <div>
                    <div>replay</div>
                    <div>Restart</div>
                </div>`}
                <div>
                    <div>delete</div>
                    <div>Clear</div>
                </div>
            </div>
        `:e.innerHTML=`
            <div class="lock-icon material-symbols-outlined">lock</div>
        `;let t=e.querySelector(".btn-start");this.b_start=t,this.d_actions=e.querySelector(".item-actions"),this.data.s&&this.data.prog!=100&&this.addFlag("inprogress"),this.data.hf?(this.addFlag("complete"),e.parentElement.classList.add("hf")):e.parentElement.classList.remove("hf"),this.data.prog==0&&!this.data.ws&&this.addFlag("new"),t&&(this.data.s?(this.tmp=t.textContent,t.onmouseenter=()=>{this.isHovering=!0,t.classList.add("material-symbols-outlined"),t.classList.remove("percent"),t.textContent=(this.data.prog==100,"more_horiz")},t.onmouseleave=()=>{this.isHovering=!1,!t.classList.contains("open")&&(t.classList.remove("material-symbols-outlined"),t.classList.add("percent"),t.textContent=this.tmp)}):(this.tmp=t.textContent,t.onmouseenter=()=>{this.isHovering=!0,this.data.s,t.classList.add("material-symbols-outlined"),t.textContent="play_arrow"},t.onmouseleave=()=>{this.isHovering=!1,!t.classList.contains("open")&&(this.data.s?t.classList.remove("material-symbols-outlined"):t.classList.add("material-symbols-outlined"),t.textContent=this.tmp)}));let l=e.querySelector("canvas");if(l){let n=function(){l.width=500,l.height=500;let p=l.getContext("2d"),u=40;p.lineWidth=u;let f=Math.PI/2,w=d/o,x=50*Math.cos((w-.44)*Math.PI*.9)*(o/a);d+=.004*x,f=d;let g=!1;(d>=o-.05||d>=a||o==0||!h.data.s)&&(f=o,g=!0),p.strokeStyle="rgba(0,0,0,0.15)",p.beginPath(),p.arc(l.width/2,l.height/2,l.width/2-u,0,Math.PI*2),p.stroke(),p.strokeStyle="green",p.beginPath(),p.arc(l.width/2,l.height/2,l.width/2-u,0,f),p.stroke(),!(d>=o||d>=a||g)&&(h.updateProgRef=requestAnimationFrame(n))},a=Math.PI*2+.05,o=this.data.prog/100*a,d=0,h=this;n()}t&&t.addEventListener("click",n=>{if(n.stopImmediatePropagation(),n.stopPropagation(),!this.data.s){ie(this.lid);return}t.classList.contains("open")?this.close():this.open()}),this.d_actions&&(this.d_actions.children[0].addEventListener("click",n=>{if(n.stopImmediatePropagation(),n.stopPropagation(),this.data.prog==100){Se(this);return}ie(this.lid,0)}),this.d_actions.children[1].addEventListener("click",n=>{n.stopImmediatePropagation(),n.stopPropagation(),Te(this)})),e.querySelector(".l-lesson-name")?.addEventListener("click",n=>{new yt(this).load()})}init(){let e=this.e;this.l.next.concat(this.l.prev),e.parentElement}deleteProgress(){this.data.eventI=-1,this.data.taskI=-1,this.data.prog=0,this.data.s=!1,this.data.sceneI=0,this.data.final_order=[],this.update()}resetProgress(){console.log(this),this.data.eventI=-1,this.data.taskI=-1,this.data.prog=0,this.data.s=!0,this.data.sceneI=0,this.data.final_order=[],this.update(),console.log(this)}}let Y=[],Ie=[];function ie(i,e=0){B.emit("startLesson",i,e,s=>{if(s!=0){alert(`Error ${s} trying to start lesson`);return}localStorage.setItem("cc-lastLID",i),U.push({path:`/learn/lesson/${i}`})})}async function Se(i){await Te(i,!0)&&ie(i.lid)}function Te(i,e=!1){return new Promise(s=>{new Ut(`${e?"Restart Lesson":"Delete Progress"}`,`Are you sure you want<br> to ${e?"restart":"delete"} lesson progress for "${i.l.name}" ?`,()=>{B.emit("deleteLessonProgress",i.l.lid,l=>{l==0?(i.deleteProgress(),s(!0)):(alert("Err: while deleting lesson progress, error code: "+l),s(!1))})},()=>{}).load().body.querySelector(".b-confirm").classList.add("warn")})}class yt extends at{constructor(e){let s=e.l.getTypeData();super("// "+s.label.toUpperCase()+(e.partNum?` (Part ${e.partNum})`:""),s.icon),this.lesson=e,this.typeData=s}lesson;typeData;p;close(e){super.close(),U.currentRoute.value.query.lid&&U.push({query:{...U.currentRoute.value.query,lid:void 0}})}load(e,s){super.load(e,s),this.outerMenu.classList.add("menu-lesson"),this.typeData.accent&&(this.outerMenu.style.setProperty("--accent",this.typeData.accent),this.outerMenu.style.setProperty("--cta-btn-col",this.typeData.accent)),this.body.innerHTML=`
            <div class="menu-block-cont" style="gap:30px;margin:10px;height:100%">
                <div class="menu-block details-block">
                    <div class="labeled-label">
                        <div>Lesson Name</div>
                        <div class="l-name">${rt(this.lesson.l.name)}</div>
                    </div>
                    <br><br>
                    <div class="start-cont">
                        <div class="l-prog">
                            ${this.lesson.data.prog}% Complete
                        </div>
                        <button class="b-more-options hide">
                            <div class="material-symbols-outlined">more_vert</div>
                        </button>
                        <button class="b-continue hide">Continue</button>
                        <button class="b-start hide">Start</button>
                    </div>
                    <br><br>
                    <div class="labeled-label">
                        <div>Description</div>
                        <div class="l-desc d-bubble">
                            ${this.lesson.l.desc.map(a=>`<div>${Ve(a)}</div>`).join("<br>")}
                            <!--<div>This is an example descripion for a lesson.<br><br>Probably a lot of useful information would go in here like what you will learn specifically in a list such as:</div>
                            <ul>
                                <li>Thing to learn 1</li>
                                <li>Another thing</li>
                                <li>You can code now</li>
                            </ul>
                            <div>And that's about it.</div>-->
                        </div>
                    </div>
                    <br><br>
                    <div class="labeled-label">
                        <div>Key Takeaways</div>
                        <div class="d-bubble">
                            <ul>
                                ${this.lesson.l.takeaways.map(a=>`<li>${Ve(a)}</li>`).join("")}
                                <!--<li>Thing to learn 1</li>
                                <li>Another thing</li>
                                <li>You can code now</li>-->
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="menu-block preview-block">
                    <div class="labeled-label" style="height:100%;display:flex;flex-direction:column">
                        <div>Sample</div>
                        <div class="sample-editor" style="height:calc(100% - 75px)">
                            
                        </div>
                    </div>
                </div>
            </div>
        `,this.loadEditor();let t=this.body.querySelector(".b-start"),l=this.body.querySelector(".b-continue"),r=this.body.querySelector(".b-more-options"),n=()=>{this.lesson.data.prog==100?l.textContent="Restart":l.textContent="Continue",this.lesson.data.s?(t.classList.add("hide"),l.classList.remove("hide"),r.classList.remove("hide")):(t.classList.remove("hide"),l.classList.add("hide"),r.classList.add("hide"))};return n(),t.addEventListener("click",a=>{ie(this.lesson.lid)}),l.addEventListener("click",async a=>{this.lesson.data.prog==100?Se(this.lesson):ie(this.lesson.lid)}),r.addEventListener("mousedown",a=>{lt(r,()=>["Delete Progress","Restart","[Debug] Continue","[Debug] ERASE META"],async o=>{o==0?await Te(this.lesson)&&(this.lesson.data.s=!1,n()):o==1?await Se(this.lesson):o==2?ie(this.lesson.lid):o==3&&B.emit("debug_eraseLessonMeta",this.lesson.lid,d=>{Bt(d)||this.close()})},{getIcons:()=>["delete","replay"]})}),this}async loadPreview(){qt(Vt.project)}async loadEditor(){await st();let e=new Ot("Sample Project",this.body.querySelector(".sample-editor"),{readonly:!1});e.builtInFileList=!0,this.p=e,Yt(e.parent,At.none),Ht(e,!0),e.parent.querySelector(".b-add-file").remove();let s=this.lesson.l.previewData;async function t(l,r){if(l)for(const n of l.items)if("buf"in n)await e.createFile(n.name,n.buf,null,r,!1);else{let a=e.createFolder(n.name,r,!1);await t(n,a)}}await t(s);for(const l of e.files)l.open(!1);e.curFile?.editor?.layout(),await this.loadPreview()}onClose(){if(this.p)for(const e of this.p.files)e.editor&&e.editor.dispose()}}let ee=10;async function ts(i){let e=T.offsetWidth/2,s=T.offsetHeight/2;console.log("----- CXCY",e,s);let{ar:t,meta:l}=await new Promise(o=>{B.emit("getProgressTree",i,d=>{if(typeof d=="number"||d==null){alert(`Error ${d} while trying to get progress tree: ${i}`);return}o(Kt(d))})}),r=await new Promise(o=>{B.emit("getLearnData",t.map(d=>d.lid),d=>{if(typeof d=="number"){alert(`Error ${d}: failed to retrieve learn progress`);return}let h=[],p=Object.keys(d);for(const u of p){let f=d[u];f&&(f.lid=u,h.push(f))}o(h)})});for(const o of t)o.root=t,o.rootProg=r;function n(o,d){if(d.includes(o.lid))return[0,0];d.push(o.lid);let h=o.prev[0];if(h){let p=o,u=t.find(x=>x.lid==h.id);if(!p)return console.warn("$ couldn't find item: ",o.lid,h.id),[0,0];if(!u)return console.warn("$ couldn't find prevItem: ",o.lid,h.id),[0,0];let[f,w]=n(u,d);return o._x=e+(o.x+f)*ee,o._y=s+(o.y+w)*ee,[o.x+f,o.y+w]}return[o.x,o.y]}for(const o of t)n(o,[]);for(const o of t)if(o._x==null){let d=e+o.x*ee,h=s+o.y*ee;o._x=d,o._y=h}t.sort((o,d)=>(o._x|d._y)-o._x*d._y);let a=document.createElement("div");O.appendChild(a);for(const o of t){await k(10);let d=r.find(g=>g.lid==o.lid),h=o._x,p=o._y,u=document.createElement("div");u.classList.add("item-cont");let f=document.createElement("div");f.classList.add("circle"),u.style.left=h+"px",u.style.top=p+"px",u.addEventListener("mouseenter",g=>{Q=!1}),u.addEventListener("mouseleave",g=>{Q=!0}),u.appendChild(f),a.appendChild(u);let w=new es(o,f,d);Y.push(w),w.update(),setTimeout(()=>{o.prev.every(g=>Y.find(D=>D.lid==g.id)?.data.hf)&&B.emit("postFinishLesson",w.lid,g=>{g!=0&&typeof g!="number"&&o.animateUnlocks(t,g)})},1e3);let x=50;if(o.prev)for(const g of o.prev){let D=t.find(W=>W.lid==g.id);if(D){let W=function(){return A+=P,H+=P,de-=P,ce-=P,m>v?m-=P:m+=P,y>b?y-=P:y+=P,v>m?v-=P:v+=P,b>y?b-=P:b+=P,!0},L=function(){let ge=_.querySelector("path"),ue=ge.getTotalLength()/2;ue=Math.floor(ue/60)*60+45;let ze=ge.getPointAtLength(ue-1),Be=ge.getPointAtLength(ue+1),Ue=ge.getPointAtLength(ue),Ct=Be.x-ze.x,Et=Be.y-ze.y,_t=Math.atan2(Et,Ct);G.style.left=Ue.x+"px",G.style.top=Ue.y+"px",G.style.transform=`translate(-50%,-50%) rotate(${_t}rad)`},_=document.createElement("div");_.classList.add("test");let A=0,H=0,de=0,ce=0,He=[o._x,D._x],Re=[o._y,D._y];A=Math.min(...He),H=Math.min(...Re),de=Math.max(...He),ce=Math.max(...Re);let $e=(de+A)/2,R=(ce+H)/2,m=D._x,y=D._y,v=o._x,b=o._y,Le=v-m,ke=b-y,Xe=Math.sqrt(Le**2+ke**2),M=Le,q=ke,ve=g.bendOther;Le/=Xe,ke/=Xe;let j="40,20";_.style.width=Math.abs(M)+"px",_.style.height=Math.abs(q)+"px",_.style.left=A+"px",_.style.top=H+"px";let I="8",he=0,P=5,kt=(Math.abs(M)+he*2)/Math.abs(M);_.innerHTML=`
                    <!--<svg viewBox="0 0 ${T.offsetWidth} ${T.offsetHeight}" xmlns="http://www.w3.org/2000/svg">-->
                    <svg style="transform:scale(${kt});margin-left:0px;margin-top:0px" viewBox="${A-he} ${H-he} ${Math.abs(M)+he*2} ${Math.abs(q)+he*2}" xmlns="http://www.w3.org/2000/svg">
        <!-- <path d="M ${A-x},${H-x} L ${de+x},${H-x} L ${de+x},${ce+x} L ${A-x},${ce+x} z" stroke="red" fill="none"/> -->

        
        <!--<path d="M ${m},${y} Q ${m},${R} ${$e},${R}" stroke="var(--col)" fill="none" stroke-dasharray="${j}" stroke-linecap="round" stroke-width="${I}"/>-->
        <!--<path d="M ${$e},${R} Q ${v},${R} ${v},${b}" stroke="var(--col)" fill="none" stroke-dasharray="${j}" stroke-linecap="round" stroke-width="${I}"/>-->

        <!--<path d="M ${m},${y} Q ${m},${R} ${$e},${R} Q ${v},${R} ${v},${b}" stroke="var(--col)" fill="none" stroke-dasharray="${j}" stroke-linecap="round" stroke-width="${I}"/>-->

        ${W(),""}
        ${M>0&&q>0&&ve?`<path d="M ${m},${y} Q ${v},${y} ${v},${b}" stroke="var(--col)" fill="none" stroke-dasharray="${j}" stroke-linecap="round" stroke-width="${I}"/>`:M>0&&q>0?`<path d="M ${m},${y} Q ${m},${b} ${v},${b}" stroke="var(--col)" fill="none" stroke-dasharray="${j}" stroke-linecap="round" stroke-width="${I}"/>`:M>0&&q<0&&ve?`<path d="M ${m},${y} Q ${m},${b} ${v},${b}" stroke="var(--col)" fill="none" stroke-dasharray="${j}" stroke-linecap="round" stroke-width="${I}"/>`:M>0&&q<0?`<path d="M ${m},${y} Q ${v},${y} ${v},${b}" stroke="var(--col)" fill="none" stroke-dasharray="${j}" stroke-linecap="round" stroke-width="${I}"/>`:M<0&&q>0&&ve?`<path d="M ${m},${y} Q ${v},${y} ${v},${b}" stroke="var(--col)" fill="none" stroke-dasharray="${j}" stroke-linecap="round" stroke-width="${I}"/>`:M<0&&q>0?`<path d="M ${m},${y} Q ${m},${b} ${v},${b}" stroke="var(--col)" fill="none" stroke-dasharray="${j}" stroke-linecap="round" stroke-width="${I}"/>`:M<0&&q<0&&ve?`<path d="M ${m},${y} Q ${m},${b} ${v},${b}" stroke="var(--col)" fill="none" stroke-dasharray="${j}" stroke-linecap="round" stroke-width="${I}"/>`:`<path d="M ${m},${y} Q ${v},${y} ${v},${b}" stroke="var(--col)" fill="none" stroke-dasharray="${j}" stroke-linecap="round" stroke-width="${I}"/>`}
    </svg>
                    `;let J=document.createElement("div");J.className="path-cont",setTimeout(()=>{O.appendChild(J)},50),g.pathCont=J,w.prevPathCont=J,J.appendChild(_);let G=document.createElement("div");G.className="arrow",L(),G.innerHTML=`
                        <svg viewBox="0 0 50 50" xmlns="http://www.w3.org/2000/svg">
                            <path d="M 5,5 L 25,25 L 5,45" stroke-width="8" fill="none" stroke="var(--col)" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    `,J.appendChild(G)}}}l&&setTimeout(()=>{if(l.objs)for(const o of l.objs){let d=z.add(o);Ie.push(d)}},0)}function ss(){let i=document.createElement("div");return i.classList.add("item-cont","type-warp-zone"),O.children[0].appendChild(i),i.style.left="1100px",i.style.top="1300px",i.innerHTML=`
        <div class="gfx-cont">
            <!--<div class="grad-cont">
                <div></div>
                <div></div>
                <div></div>
            </div>-->
            <svg width="400" height="400" class="blend-group-0">
                <rect class="blend-item" x="150" y="150" width="100" height="100" fill="rgb(255,0,0)" rx="20" ry="20"></rect>
                <rect class="blend-item" x="150" y="150" width="100" height="100" fill="rgb(0,255,0)" rx="20" ry="20"></rect>
                <rect class="blend-item" x="150" y="150" width="100" height="100" fill="rgb(0,0,255)" rx="20" ry="20"></rect>
            </svg>
            <!--<svg width="400" height="400" class="blend-group-1">
                <rect class="blend-item" x="150" y="150" width="100" height="100" fill="rgb(255,0,0)" rx="20" ry="20"></rect>
                <rect class="blend-item" x="150" y="150" width="100" height="100" fill="rgb(0,255,0)" rx="20" ry="20"></rect>
                <rect class="blend-item" x="150" y="150" width="100" height="100" fill="rgb(0,0,255)" rx="20" ry="20"></rect>
            </svg>-->
        </div>
    `,i}function is(i,e){let s=document.createElement("div");return s.classList.add("item-cont","type-sign"),s.style.left=i+"px",s.style.top=e+"px",s.innerHTML=`
        <div class="sign-cont">
            <div class="sign-stem"></div>
            <div class="sign-back"></div>
            <div class="sign-face">
                <div>[...]</div>
            </div>
        </div>
    `,s}var bt=(i=>(i[i.sign=0]="sign",i[i.warp=1]="warp",i[i.banner=2]="banner",i[i.element=3]="element",i[i.group=4]="group",i))(bt||{});class ls{constructor(){this.reg=new Map,this.objCont=document.createElement("div"),O.appendChild(this.objCont)}reg;objCont;register(e){let s=e.getType();if(this.reg.has(s)){console.warn("$ learn object registry already has an entry with the type: ",bt[s]);return}this.reg.set(s,e)}add(e){let s=this.reg.get(e.type);if(!s){console.warn("Failed to find ref: ",e);return}let t=s.parse(e);if(!s){console.warn("Failed to find LearnObj type in registry: ",e);return}let l=t.load();if(t.hasManualPostLoad()||t.postLoad(),!s){console.warn("Failed to load elm from LearnObj load: ",e);return}return this.objCont.appendChild(l),t.relObj&&!t.relObj.data.u&&t.hideObj(),e.hide&&l.classList.add("hide"),t}}let z;class F{constructor(){}x;y;id;data;rel;relObj;elm;hide;wasJustUnlocked=!1;postLoad(){this.elm.style.left=this.x+"px",this.elm.style.top=this.y+"px",this.elm.classList.add("lo-any"),this.wasJustUnlocked=!1}hasManualPostLoad(){return!1}static parseSuper(e,s){if(e.id=s.id,e.data=s.data,e.rel=s.rel,s.rel){let[t,l]=s.rel.split("@");if(t!="o"){if(t=="l"){let r=Y.find(n=>n.lid==l);if(!r){console.warn(`$ err: not good! couldn't find relation object for learn obj:

`,t,l,s.type,s.id);return}e.x=r.l._x+s.x*ee,e.y=r.l._y+s.y*ee,e.relObj=r}}}else e.x=s.x,e.y=s.y}showObj(){this.hide||this.elm&&(this.elm.classList.remove("force-hide"),this.wasJustUnlocked=!0)}hideObj(){this.elm&&this.elm.classList.add("force-hide")}}class De extends F{constructor(){super()}getType(){return 0}parse(e){let s=new De;return F.parseSuper(s,e),s}load(){let e=is(this.x,this.y);return e.querySelector(".sign-face").addEventListener("click",t=>{this.open()}),this.elm=e,e}open(){new ns(this).load()}}class ns extends at{constructor(e){super("A Sign","lightbulb"),this.obj=e}obj;load(e,s){super.load(e,s),this.menu.classList.add("menu-sign"),this.menu.style.setProperty("--accent","rgb(91, 49, 18)");let t=document.createElement("div");t.className="sign-menu-list menu-block";let l;const r=()=>{l=document.createElement("p"),l.classList.add("d-bubble"),t.appendChild(l)};if(r(),this.obj.data){if(this.obj.data.title){let n=document.createElement("h3");n.textContent=this.obj.data.title,n.classList.add("sign-title"),t.insertBefore(n,t.children[0])}for(const n of this.obj.data.desc){if(n.startsWith("$")){n.substring(1)=="br"&&r();continue}let a=document.createElement("p");a.textContent=n,l.appendChild(a)}}else{let n=document.createElement("p");n.textContent="[ There doesn't seem to be any text on the sign. ]",n.style.textAlign="center",l.appendChild(n)}return this.body.appendChild(t),this}}class Ne extends F{constructor(){super()}getType(){return 2}parse(e){let s=new Ne;return F.parseSuper(s,e),s}load(){let e=document.createElement("div");e.className="lo-banner";let s=document.createElement("div");return s.textContent=this.data.title,e.appendChild(s),this.elm=e,e}}class Fe extends F{constructor(){super()}hasCreatedParts=!1;getType(){return 3}parse(e){let s=new Fe;return F.parseSuper(s,e),s}cont;load(){let e=document.createElement("div");e.className="lo-element",this.elm=e;let s=document.createElement("div");if(s.className="lo-element-ops",e.appendChild(s),this.relObj){let l=document.createElement("div");l.className="icon-btn normal",l.innerHTML="<div>info</div>",l.onclick=()=>{alert(`These little snippets are examples of something you could create using the information learned in this lesson.

This one is based off the lesson: "`+this.relObj.l.name.toUpperCase()+'"')},s.appendChild(l),ot(l,"Info")}let t=document.createElement("div");return this.cont=t,t.className="lo-element-cont",e.appendChild(t),setTimeout(()=>{!this.hasCreatedParts&&this.relObj.data.u&&this.createPart(this.data,t,!1)},50),t.addEventListener("mouseenter",l=>{Q=!1}),t.addEventListener("mouseleave",l=>{Q=!0}),this.elm}async createPart(e,s,t){if(this.hasCreatedParts=!0,e.tag=="script"){console.warn("Sorry! scripts aren't allowed to be loaded dynamically yet using learnObj elements!");return}let l=document.createElement(e.tag);s.appendChild(l);let r=!this.relObj?.data.u;if(t!=null&&(r=t),r&&await k(200),e.className&&(l.className=e.className),e.attr){let n=Object.keys(e.attr);for(const a of n)l.setAttribute(a,e.attr[a]),r&&await k(200)}if(e.style){let n=Object.keys(e.style);for(const a of n)l.style[a]=e.style[a],r&&await k(200)}if(e.children)for(const n of e.children)await this.createPart(n,l),r&&await k(200);return e.text&&(r&&await k(200),l.textContent=e.text),l}showObj(){this.hasCreatedParts?console.log("ERR: parts were already created!"):this.createPart(this.data,this.cont,!0),super.showObj()}}let N;class qe extends F{getType(){return 1}parse(e){let s=new qe;return F.parseSuper(s,e),s}load(){return this.elm=ss(),this.elm.addEventListener("click",async e=>{if(K.warping)return;N&&N.remove(),N=document.createElement("div"),document.body.insertBefore(N,document.body.children[0]),N.className="warp-cover";let s=this.elm.getBoundingClientRect(),t=s.x+s.width/2,l=s.y+s.height/2;N.style.left=`${t}px`,N.style.top=`${l}px`,K.warping=!0,await k(1e3),await U.push({path:"/learn",query:{f:this.data.folder}}),K.learnFolder=this.data.folder,await $t(),await k(50),N.classList.add("leave"),await k(750),N.remove(),N=void 0,K.warping=!1}),this.elm}constructor(){super()}}class Oe extends F{getType(){return 4}parse(e){let s=new Oe;return F.parseSuper(s,e),s}load(){let e=document.createElement("div");e.className="lo-group",this.elm=e;for(const s of this.data.lessons){let t=Y.find(r=>r.lid==s);if(!t){console.warn("couldn't find lesson item with lid: ",s);continue}let l=document.createElement("div");l.appendChild(t.e),e.appendChild(l)}return e}}let Q=!0,Me=0,je=0,le=0,ne=0,oe=!1,C=0,E=0,c=1,Ye=5,ae=0,re=0,me=0;function os(){me++,S.classList.add("animate")}function as(){me--,me<=0&&S.classList.remove("animate")}function we(){return me>0}let Z,ye=1;function V(){if(!S)return;S.style.marginLeft=C+"px",S.style.marginTop=E+"px";let i=S.getBoundingClientRect(),e=i.x+i.width/2,s=i.y+i.height/2;fe.style.backgroundPositionX=e+"px",fe.style.backgroundPositionY=s+"px"}function Ae(i){c*=i,c<.1&&(c=.1),c>5&&(c=5);let e=S.getBoundingClientRect();S.style.scale=c.toString(),fe.style.backgroundSize=c*Ye+"vw";let s=S.getBoundingClientRect(),t=s.width-e.width,l=s.height-e.height,r=ae-(e.x+e.width/2),n=re-(e.y+e.height/2),a=r/e.width,o=n/e.height;C-=t*a,E-=l*o,V(),xe=!0}let xe=!1;function wt(i){S&&(c=i,c<.1&&(c=.1),c>5&&(c=5),S.style.scale=c.toString(),fe.style.backgroundSize=c*Ye+"vw")}function xt(){pe=[],Y=[],Ie=[],Q=!0,Me=0,je=0,le=0,ne=0,oe=!1,C=0,E=0,c=1,Ye=5,ae=0,re=0,me=0,Z=[],ye=1,xe=!1,X=[]}async function $t(){if(!await Xt())return;We.loadingProgressTree=!0,await st(),xt(),fe=document.querySelector(".main"),T=document.querySelector(".p-tree"),S=document.querySelector(".pan-cont"),O=document.querySelector(".cont"),O.textContent="",Jt(),z=new ls,z.register(new De),z.register(new Ne),z.register(new Fe),z.register(new qe),z.register(new Oe);let e=new URL(location.href).searchParams.get("f")??"theBeginnings";await ts(e),We.loadingProgressTree=!1;let s=U.currentRoute.value.query.lid;if(s){let t=Y.find(l=>l.lid==s);it(),t&&new yt(t).load()}}function Lt(){localStorage.setItem("cc-panX",(C||0).toString()),localStorage.setItem("cc-panY",(E||0).toString()),localStorage.setItem("cc-zoom",(c||1).toString())}function rs(){C=0,E=0,V(),wt(1),xe=!0}const ds={class:"load-cont lesson"},cs={__name:"FullscreenLoading",setup(i){return Ze(()=>{console.warn("LOADING")}),Ke(()=>{console.warn("NOT LOADING")}),(e,s)=>(Pe(),et("div",ds,s[0]||(s[0]=[$("div",{class:"items"},[$("div",{class:"material-symbols-outlined loading"},"progress_activity")],-1)])))}},hs=dt(cs,[["__scopeId","data-v-87920263"]]),us={class:"extra-overlay"},ps={class:"live-lessons"},fs={class:"main"},ms=St({__name:"LearnView",setup(i){const e=tt(),s=ct();Ze(async()=>{Ee("/styles/learn.css"),Ee("/styles/editor.css"),Ee("/styles/flashcards.css"),await $t()}),Ke(()=>{Qt(),Wt(),it(),nt(!0),e.$reset()});const t=Ge("");function l(){let r=t.value;r&&r.length==4&&(console.log("attempting to join live lesson with code:",r),B.emit("join-live-lesson",r,n=>{if(!n){let a="Failed to join live lesson";console.warn(a),alert(a);return}if(typeof n=="number"){let a=`Failed to join live lesson with code: ${n}`;console.warn(a),alert(a);return}else if("err"in n){let a=`Failed to join live lesson with code: ${n.err}`;console.warn(a),alert(a);return}alert("Joined live lesson at code: "+r),console.log(":: joined lesson with code",r,n),U.push({path:`/learn/lesson/live-${r}`})}))}return(r,n)=>(Pe(),et(Dt,null,[Qe(Rt,{"btn-index":0,"page-id":"learn"}),n[4]||(n[4]=$("div",{class:"learn-page"},null,-1)),Qe(jt,{name:"fade-transition"},{default:Mt(()=>[Ce(s).loadingProgressTree?(Pe(),Nt(hs,{key:0})):Ft("",!0)]),_:1}),$("div",us,[$("div",ps,[n[2]||(n[2]=$("div",{style:{"margin-inline":"8px"}},"Join Live Lesson",-1)),It($("input",{"onUpdate:modelValue":n[0]||(n[0]=a=>t.value=a),type:"text",name:"live-lesson-code",id:"live-lesson-code",placeholder:"Join code"},null,512),[[Tt,t.value]]),$("button",{class:"accent button-thin",onClick:l},"Join")])]),n[5]||(n[5]=$("div",{class:"center-mark"},null,-1)),$("div",fs,[$("div",{onClick:n[1]||(n[1]=(...a)=>Ce(Je)&&Ce(Je)(...a)),class:"view-options material-symbols-outlined"},"menu"),n[3]||(n[3]=$("div",{class:"p-tree"},[$("div",{class:"pan-cont"},[$("div",{class:"cont"})])],-1))])],64))}}),Ls=dt(ms,[["__scopeId","data-v-f07daf33"]]);export{Ls as default};
