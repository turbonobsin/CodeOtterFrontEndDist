import{d as Ie,a as o,k as V,b as _e,f as l,g as Ae,h as s,c as T,l as d,p as P,u as b,L as Me,t as u,F as y,G as w,n as ee,M as G,w as p,v as _,N as Ue,m as x,O as F,P as Te,o as a,D as Pe}from"./index-BA_zY1xG.js";import{H as Ne,M as N}from"./Header-qTmbpJZ4.js";import{u as je,w as Le,V as C,C as H}from"./util-BTTZT_bN.js";import{_ as Ee}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./xterm-CbIsyoms.js";const Oe={class:"main"},Ve={class:"flex"},Re={class:"assignment-options-cont"},qe={key:0,class:"error-message"},Ge={key:1,class:"error-message"},Je={key:2},$e={class:"lesson-checkboxes"},Be=["value"],Fe={class:"flex"},He={class:"flex"},We={key:0,for:"assignmentPublishDate"},ze={key:0,class:"error-message"},Qe={class:"join-menu-cont"},Ye={key:0,class:"error-message"},Ze={class:"class-options-cont"},Ke={class:"flex"},Xe={class:"flex-col"},es={class:"banned-users"},ss={key:0,class:"txt-subtle"},ts={class:"flex banned-user"},ns=["onClick"],as={class:"manage-class-container"},ls={class:"manage-class-header"},os={class:"join-code-cont"},is={class:"material-symbols-outlined"},us={class:"manage-class-body"},rs={class:"manage-class-left"},ds={key:0,class:"student-container"},cs={key:1,class:"student-container"},vs={class:"student-item"},ms=["src"],ps=["onClick"],gs={class:"manage-class-right"},fs={key:0,class:"assignments-empty assignment"},ys={class:"assignments-full assignment"},Cs=["onClick"],bs={class:"classes"},hs={class:"class-header"},ks={key:0,class:"header-right"},ws={key:1,class:"header-right"},xs={class:"class-bottom"},Ds={class:"selection-opx"},Ss=["onClick"],Is={key:0,class:"empty-container"},_s={class:"card"},As={class:"card-left"},Ms={class:"instructor"},Us={class:"card-right"},Ts=["onClick"],Ps={key:2,class:"empty-container"},Ns={key:0},js={class:"card"},Ls={class:"card-left"},Es=Ie({__name:"ClassesView",setup(Os){const se=je(),g=o([]),m=o([]);let f=o(!0);const h=o(!1);function te(){h.value&&(f.value=!f.value)}let k=o(!1);const r=o();let ne=V("createClassMenu");async function ae(){r.value={name:"New Class",students:[],instructor:{name:"",uid:void 0},assignments:[],endDate:new Date,isLocked:!1,bannedUsers:[]},k.value=!k.value}async function le(){if(!r.value.name||!r.value.publishDate||!r.value.endDate){console.error("Missing required fields");return}if(r.value.endDate<=r.value.publishDate){console.error("End date must be after publish date");return}await oe(Pe(r.value)),k.value=!1}async function oe(n){console.log("Sending request to create class...");try{let e=await C("POST","/classes",{autoToken:!0,body:n});console.log("Server (post class): ",e.data),m.value.push(e.data)}catch(e){console.log("Could not create class: ",e)}}async function W(n){try{let e=await C("GET","/classes/",{query:{instructorClasses:n}});if(e.code!=500)return await JSON.parse(e.text)}catch(e){return console.log("Could not create assignment: ",e),[]}}const D=o(!1),A=o("");V("joinClassMenu");async function z(){A.value="",D.value=!D.value}const M=o("");async function ie(){const n=A.value.trim();if(M.value="",n.length!==6){console.error("Join code must be exactly 6 characters");return}await ue(n)}async function ue(n){try{let e=await C("PATCH","/classes/join/:joinCode",{params:{joinCode:n}});if(console.log("Server (join class): ",e),e.code===403){M.value=e.text;return}if(e.code!==200||!e.data){console.error("Join failed",e.text),M.value=e.text||"Unknown error...";return}g.value.push(e.data),D.value=!1}catch(e){console.log("Could not join class: ",e)}}const Q=o(0),re=[{name:"ONGOING CLASSES",index:0},{name:"UPCOMING CLASSES",index:1},{name:"PAST CLASSES",index:2}],J=o(),$=o();function de(n){switch(Q.value=n,n){case 1:$.value=m.value.filter(e=>e.publishDate.getTime()<=new Date().getTime()),J.value=g.value.filter(e=>e.publishDate.getTime()<=new Date().getTime());case 2:$.value=m.value.filter(e=>e.publishDate.getTime()>new Date().getTime()),J.value=g.value.filter(e=>e.publishDate.getTime()>new Date().getTime());case 3:$.value=m.value.filter(e=>e.endDate.getTime()<new Date().getTime()),J.value=g.value.filter(e=>e.endDate.getTime()<new Date().getTime())}}_e(async()=>{await Le()&&(g.value=await W(!1),console.log("Fetched student classes ",g.value),h.value=se.g_user.data.isInstructor,h.value&&(f.value=!0,m.value=await W(!0),console.log("Fetched instructor classes ",m.value)),console.log("instructor status: "+h.value))});const U=o(!1),i=o(),Y=o("");V("manageClassMenu");async function ce(n){i.value=n,Y.value=n.name.toString(),U.value=!U.value}const j=o();async function ve(n){await me(n._id),await ce(n)}async function me(n){try{let e=await C("GET","/classes/:classId/assignments",{params:{classId:n}});if(console.log("Server (get assignments): ",e),e.code!==200||!e.data){console.error("Fetch assignments failed",e.text);return}j.value=e.data}catch(e){console.log("Could not join class: ",e)}}async function Z(n,e){new H("<div style='display:flex;gap:1em;padding-top:1rem;'><span class='material-symbols-outlined'>gavel</span><span>Ban user</span></div>","<div style='display:flex;padding:0.5em 1em;'>Are you sure you want to ban this user?</div>",async()=>{await pe(n,e)},()=>{},"Ban user","Cancel").load()}async function pe(n,e){try{let t=await C("PATCH","/classes/:classId/ban",{params:{classId:i.value._id},query:{banUser:e,banning:n}});t.data&&(i.value.students=t.data.students,i.value.bannedUsers=t.data.bannedUsers),console.log("Server (ban user): ",t.data)}catch(t){console.log("Could not join class: ",t)}}async function ge(){i.value.isLocked=!i.value.isLocked,await fe({isLocked:i.value.isLocked})}async function fe(n){let e=n;try{let t=await C("PATCH","/classes/:classId",{params:{classId:i.value._id},body:e});console.log("Server (edit class): ",t),g.value.find(v=>{v._id===t.data._id&&(v=t.data)}),D.value=!1}catch(t){console.log("Could not join class: ",t)}}async function K(){M.value="",L.value="",E.value=""}function ye(n){const e=encodeURIComponent(n);return`${Te}/proxy?url=${e}`}V("createAssignmentMenu");const S=o(!1),c=o(),B=o("Lessons"),R=o(!0),X=o();async function Ce(){I.value=!1,c.value={name:"",publishDate:new Date,classId:void 0,dueDate:new Date,completions:[],assignedContent:{instructions:"",lessons:[],projects:[],challenges:[]}},S.value=!S.value;try{let n=await C("GET","/classes/:classId/lessons",{params:{classId:i.value._id}});console.log("Server (get lesson data): ",n),X.value=n.data}catch(n){console.log("Could not get lesson metadata: ",n)}}const L=o(""),E=o(""),q=o("");async function be(){if(c.value.name.length<3){L.value="Assignment name must be 3 characters";return}else if(c.value.assignedContent.instructions.length<3){E.value="Please add instructions";return}else q.value="",E.value="",L.value="";try{let n=await C("POST","/classes/:classId/assignments",{params:{classId:i.value._id},body:c.value});if(!n.ok||!n.data){n.code==400&&(q.value="Please specify assignment content."),console.warn("Could not create assignment",n.code,"data: "+n.text);return}console.log("Server (create assignment): ",n),i.value.assignments.push(n.data._id),j.value.push(n.data),S.value=!1}catch(n){console.log("Could not create assignment: ",n)}}async function he(n){new H("<div style='display:flex;gap:1em;padding-top:1rem;'><span class='material-symbols-outlined'>delete</span><span>Delete Assignment</span></div>","<div style='display:flex;padding:0.5em 1em;'>Are you sure you want to delete this assignment?</div>",async()=>{try{let e=await C("DELETE","/classes/:classId/assignments/:assignmentId",{params:{classId:i.value._id,assignmentId:n}});if(e.ok){let t=j.value.findIndex(v=>v._id==n);t!=-1&&j.value.splice(t,1),t=i.value.assignments.indexOf(n),t!=-1&&i.value.assignments.splice(t,1)}console.log("Server (delete assignment): ",e.data)}catch(e){console.log("Could not join class: ",e)}},()=>{},"Delete Assignment","Cancel").load()}const I=o(!1),ke=V("classSettingsMenu");async function we(){S.value=!1,I.value=!I.value}async function xe(){U.value=!1,I.value=!1,new H("<div style='display:flex;gap:1em;padding-top:1rem;'><span class='material-symbols-outlined'>delete</span><span>Delete Class</span></div>","<div style='display:flex;padding:0.5em 1em;'>Are you sure you want to delete this class?</div>",async()=>{let n=i.value;try{let e=await C("DELETE","/classes/:classId",{params:{classId:n._id}});if(e.ok){let t=m.value.indexOf(n);t!=-1&&m.value.splice(t,1)}console.log("Server (delete class): ",e.data)}catch(e){console.log("Could not delete class: ",e)}},()=>{},"Delete Class","Cancel").load()}const O=o(),De=o();async function Se(){O.value=!O.value}return(n,e)=>(a(),l(y,null,[Ae(Ne,{"btn-index":3}),s("div",Oe,[O.value?(a(),T(N,{key:0,ref:"viewAssignmentMenu",title:"Assignment Details",opened:O.value,"onUpdate:opened":e[0]||(e[0]=t=>O.value=t),icon:"info",height:"min-content",width:"700px","new-layer":!0},{default:P(()=>[s("div",Ve,[(a(!0),l(y,null,w(De.value,t=>(a(),l("div"))),256))])]),_:1},8,["opened"])):d("",!0),S.value?(a(),T(N,{key:1,ref:"createAssignmentMenu",title:"Create Assignment",opened:S.value,"onUpdate:opened":e[7]||(e[7]=t=>S.value=t),icon:"assignment_add",height:"min-content",width:"400px",onOnClose:e[8]||(e[8]=t=>K())},{default:P(()=>[s("form",{class:"assignment-menu-cont",onSubmit:G(be,["prevent"])},[e[28]||(e[28]=s("span",null,"Fill out the options below to create an assignment.",-1)),s("div",Re,[e[25]||(e[25]=s("label",{for:"assignmentName"},"Name: ",-1)),p(s("input",{"onUpdate:modelValue":e[1]||(e[1]=t=>c.value.name=t),placeholder:"Assignment Name",id:"assignmentName",class:"assignment-input",type:"text",minlength:"3",required:""},null,512),[[_,c.value.name,void 0,{trim:!0}]]),L.value?(a(),l("span",qe,u(L.value),1)):d("",!0),e[26]||(e[26]=s("label",{for:"assignmentInstructions"},"Instructions:",-1)),p(s("input",{type:"text",id:"assignmentInstructions",required:"","onUpdate:modelValue":e[2]||(e[2]=t=>c.value.assignedContent.instructions=t),placeholder:"Complete the following work",minlength:"2",maxlength:"1024"},null,512),[[_,c.value.assignedContent.instructions,void 0,{trim:!0}]]),E.value?(a(),l("span",Ge,u(E.value),1)):d("",!0),e[27]||(e[27]=s("label",{for:"assignmentContent"},"Assignment Type: ",-1)),p(s("select",{id:"assignmentContent",required:"",class:"assignment-content","onUpdate:modelValue":e[3]||(e[3]=t=>B.value=t)},e[22]||(e[22]=[s("option",{value:"Lessons"},"Lesson",-1),s("option",{disabled:"",value:"Challenges"},"Challenge",-1),s("option",{disabled:"",value:"Projects"},"Project",-1)]),512),[[Ue,B.value]]),B.value==="Lessons"?(a(),l("div",Je,[e[23]||(e[23]=s("label",null,"Select lesson(s) to assign:",-1)),s("div",$e,[(a(!0),l(y,null,w(X.value,t=>(a(),l("label",{key:t.lid},[p(s("input",{type:"checkbox",value:t.lid,"onUpdate:modelValue":e[4]||(e[4]=v=>c.value.assignedContent.lessons=v)},null,8,Be),[[F,c.value.assignedContent.lessons]]),x(" "+u(t.name),1)]))),128))])])):d("",!0),s("div",Fe,[e[24]||(e[24]=s("label",{for:"assignmentPublishNow"},"Publish now?",-1)),p(s("input",{type:"checkbox",id:"assignmentPublishNow","onUpdate:modelValue":e[5]||(e[5]=t=>R.value=t)},null,512),[[F,R.value]])]),s("div",He,[R.value?d("",!0):(a(),l("label",We," Publish At: ")),R.value?d("",!0):p((a(),l("input",{key:1,"onUpdate:modelValue":e[6]||(e[6]=t=>c.value.publishDate=t),id:"assignmentPublishDate",class:"assignment-date-input",type:"date",required:""},null,512)),[[_,c.value.publishDate]])])]),e[29]||(e[29]=s("button",{type:"submit",class:"assignment-submission"},[s("span",null,"Create assignment "),s("span",{class:"material-symbols-outlined"},"arrow_right_alt")],-1)),q.value.length>=1?(a(),l("span",ze,u(q.value),1)):d("",!0)],32)]),_:1},8,["opened"])):d("",!0),D.value?(a(),T(N,{key:2,ref:"joinClassMenu",title:"Join Class",opened:D.value,"onUpdate:opened":e[11]||(e[11]=t=>D.value=t),icon:"Group",height:"min-content",width:"max-content",onOnClose:K},{default:P(()=>[s("div",Qe,[e[32]||(e[32]=s("span",null,"Enter 6-digit code to join a class:",-1)),s("form",{class:"join-options-cont",onSubmit:G(ie,["prevent"])},[p(s("input",{"onUpdate:modelValue":e[9]||(e[9]=t=>A.value=t),class:"join-input",type:"text",placeholder:"QRF234",maxlength:"6",minlength:"6",pattern:"[A-Z0-9]{6}",required:"",onInput:e[10]||(e[10]=t=>A.value=A.value.toUpperCase().trim())},null,544),[[_,A.value]]),e[30]||(e[30]=s("button",{type:"submit",class:"material-symbols-outlined join-submission"}," arrow_right_alt ",-1))],32),M.value?(a(),l("span",Ye,[e[31]||(e[31]=s("span",{class:"material-symbols-outlined"},"lock",-1)),x(u(M.value),1)])):d("",!0)])]),_:1},8,["opened"])):d("",!0),b(k)?(a(),T(N,{key:3,ref_key:"createClassMenu",ref:ne,title:"Create Class",opened:b(k),"onUpdate:opened":e[16]||(e[16]=t=>Me(k)?k.value=t:k=t),icon:"Group",height:"min-content",width:"max-content"},{default:P(()=>[s("form",{class:"class-menu-cont",onSubmit:G(le,["prevent"])},[e[37]||(e[37]=s("span",null,"Fill out the options below to create a class.",-1)),s("div",Ze,[e[34]||(e[34]=s("label",{for:"className"},"Name: ",-1)),p(s("input",{"onUpdate:modelValue":e[12]||(e[12]=t=>r.value.name=t),placeholder:`Class
						Name`,id:"className",class:"class-input",type:"text",minlength:"6",required:""},null,512),[[_,r.value.name,void 0,{trim:!0}]]),e[35]||(e[35]=s("label",{for:"classPublishDate"},"Publish Date: ",-1)),p(s("input",{"onUpdate:modelValue":e[13]||(e[13]=t=>r.value.publishDate=t),id:"classPublishDate",class:"class-date-input",type:"date",required:""},null,512),[[_,r.value.publishDate]]),e[36]||(e[36]=s("label",{for:"classEndDate"},"End Date: ",-1)),p(s("input",{"onUpdate:modelValue":e[14]||(e[14]=t=>r.value.endDate=t),id:"classEndDate",class:"class-date-input",type:"date",required:""},null,512),[[_,r.value.endDate]]),s("div",Ke,[e[33]||(e[33]=s("label",{for:"classIsLocked"},"Disable join code: ",-1)),p(s("input",{"onUpdate:modelValue":e[15]||(e[15]=t=>r.value.isLocked=t),id:"classIsLocked",class:"class-is-locked",type:"checkbox"},null,512),[[F,r.value.isLocked]])])]),e[38]||(e[38]=s("button",{type:"submit",class:"class-submission"},[s("span",null,"Create class "),s("span",{class:"material-symbols-outlined"},"arrow_right_alt")],-1))],32)]),_:1},8,["opened"])):d("",!0),I.value?(a(),T(N,{key:4,ref_key:"classSettingsMenu",ref:ke,title:"Class Settings",opened:I.value,"onUpdate:opened":e[17]||(e[17]=t=>I.value=t),icon:"settings",height:"min-content",width:"max-content"},{default:P(()=>[s("div",Xe,[s("div",es,[e[40]||(e[40]=s("div",{class:"flex-st"},[s("span",{class:"material-symbols-outlined"}," manage_accounts "),x(" Banned Users ")],-1)),i.value.bannedUsers.length<=0?(a(),l("div",ss," Good news... No banned users! ")):(a(!0),l(y,{key:1},w(i.value.bannedUsers,t=>(a(),l("div",ts,[s("span",null,u(t.name),1),s("button",{class:"warn",onClick:v=>Z(!1,t._id)},e[39]||(e[39]=[x(" Unban "),s("span",{class:"material-symbols-outlined"},"gavel",-1)]),8,ns)]))),256))]),s("button",{class:"warn",onClick:xe},e[41]||(e[41]=[x(" Delete Class"),s("span",{class:"material-symbols-outlined"},"delete",-1)]))])]),_:1},8,["opened"])):d("",!0),U.value?(a(),T(N,{key:5,ref:"manageClassMenu",title:Y.value,opened:U.value,"onUpdate:opened":e[19]||(e[19]=t=>U.value=t),icon:"Group",height:"min-content",width:"700px"},{default:P(()=>[s("div",as,[s("div",ls,[s("div",os,[e[42]||(e[42]=s("span",{class:"usn"},"Join Code: ",-1)),s("span",null,u(i.value.joinCode.toUpperCase()),1),s("button",{onClick:ge},[s("span",is,u(i.value.isLocked?"lock":"lock_open_right"),1)]),e[43]||(e[43]=s("button",null,[x(" Copy "),s("span",{class:"material-symbols-outlined"},"content_copy")],-1))]),s("div",{class:"edit-class-cont"},[s("button",{onClick:we},e[44]||(e[44]=[x(" Class Settings "),s("span",{class:"material-symbols-outlined"},"settings",-1)]))])]),s("div",us,[s("div",rs,[e[46]||(e[46]=s("div",{class:"flex"},[s("h3",null,"Students:"),s("button",{style:{visibility:"hidden"}},[s("span",{class:"material-symbols-outlined"},"add")])],-1)),i.value.students.length<=0?(a(),l("div",ds,e[45]||(e[45]=[s("span",null,"No students",-1)]))):(a(),l("div",cs,[(a(!0),l(y,null,w(i.value.students,t=>(a(),l("div",vs,[s("img",{crossorigin:"",src:ye(t.pfpURL),alt:"Profile Picture",ref_for:!0,ref:"userProfilePicture",class:"student-pfp"},null,8,ms),s("span",null,u(t.name),1),s("button",{class:"material-symbols-outlined warn",onClick:v=>Z(!0,t.studentId.toString())}," gavel ",8,ps)]))),256))]))]),s("div",gs,[s("div",{class:"flex"},[e[48]||(e[48]=s("h3",null,"Assignments:",-1)),s("button",{onClick:Ce},e[47]||(e[47]=[x(" Create "),s("span",{class:"material-symbols-outlined"},"add",-1)]))]),i.value.assignments.length<=0?(a(),l("div",fs,e[49]||(e[49]=[s("span",null,"Nothing to see here... Click the '+' icon to create an assignment!",-1)]))):(a(!0),l(y,{key:1},w(j.value,t=>(a(),l("div",ys,[s("span",{class:"flex",onClick:e[18]||(e[18]=v=>Se())},[s("span",null,u(t.name),1),s("button",{class:"material-symbols-outlined delete warn",onClick:G(v=>he(t._id),["stop"])}," delete ",8,Cs)])]))),256))])])])]),_:1},8,["title","opened"])):d("",!0),s("div",bs,[s("div",hs,[e[52]||(e[52]=s("div",{class:"header-left"},[s("span",{class:"material-symbols-outlined header-icon"},"group"),s("h1",null,"CLASS DASHBOARD")],-1)),h.value?(a(),l("div",ks,[s("button",{onClick:te}," INSTRUCTOR VIEW "+u(b(f)?"(on)":"(off)"),1),s("button",{class:"newButton",onClick:e[20]||(e[20]=t=>b(f)?ae():z())},[s("span",null,u(b(f)?"CREATE":"JOIN")+" CLASS",1),e[50]||(e[50]=s("span",{class:"material-symbols-outlined"},"add",-1))])])):(a(),l("div",ws,[s("button",{class:"newButton",onClick:e[21]||(e[21]=t=>z())},e[51]||(e[51]=[s("span",null,"JOIN CLASS",-1),s("span",{class:"material-symbols-outlined"},"add",-1)]))]))]),s("div",xs,[s("div",Ds,[(a(),l(y,null,w(re,t=>s("span",{class:ee([{active:Q.value===t.index},"class-category"]),key:t.index,onClick:v=>de(t.index)},u(t.name),11,Ss)),64))]),s("div",{class:ee(["class-container",{"instructor-classes":b(f),"student-classes":!b(f)}])},[h.value&&b(f)&&m.value.length<=0?(a(),l("div",Is,e[53]||(e[53]=[s("span",null,"This is where you'll manage the classes for which you're an instructor.",-1),s("span",null,'Click the "Create Class" button to get started!',-1)]))):h.value&&b(f)&&m.value.length>=1?(a(!0),l(y,{key:1},w(m.value,t=>(a(),l("div",_s,[s("div",As,[s("h3",null,u(t.name),1),s("span",Ms,"Instructor: "+u(t.instructor.name),1)]),s("div",Us,[s("button",{onClick:v=>ve(t)}," Manage Class ",8,Ts)])]))),256)):g.value.length<=0?(a(),l("div",Ps,[e[54]||(e[54]=s("span",null,`You're not in any classes yet! To join one, ask your instructor for a join code and click "Join Class" to get started.`,-1)),h.value?(a(),l("span",Ns,"Psst - We see you're an instructor! If you're looking to create/manage classes, click on the instructor view toggle.")):d("",!0)])):(a(),l(y,{key:3},[g.value.length>=1?(a(!0),l(y,{key:0},w(g.value,t=>(a(),l("div",js,[s("div",Ls,[s("h3",null,u(t.name),1),s("span",null,"Professor: "+u(t.instructor.name),1)]),e[55]||(e[55]=s("div",{class:"card-right"},[s("button",null,"View Class")],-1))]))),256)):d("",!0)],64))],2)])])])],64))}}),$s=Ee(Es,[["__scopeId","data-v-69b1118a"]]);export{$s as default};
